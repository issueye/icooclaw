# PRD文档（产品需求文档）

## 2.1 产品概述

**产品名称：** icooclaw

**产品定位：** 超轻量级个人AI助手框架

**核心价值：** 在约4000行核心代码内提供完整的Agent能力，支持多平台接入、多模型接入

**目标用户：** 
- 个人开发者
- 研究人员
- 需要私有部署AI助手的技术用户

## 2.2 功能列表

### 2.2.1 核心功能

| 功能 | 描述 | 目标用户 |
|------|------|----------|
| **WebSocket通道** | 通用WebSocket长连接 | 所有用户 |
| **Webhook通道** | HTTP回调接收消息 | 所有用户 |
| **多LLM Provider** | 支持15+种大语言模型接入 | 所有用户 |
| **Agent对话** | 基于工具调用的智能对话 | 所有用户 |
| **会话管理** | 多会话隔离，自动历史记录 | 所有用户 |
| **长期记忆** | MEMORY.md + HISTORY.md 双层记忆 | 所有用户 |
| **定时任务** | Cron表达式定时任务 | 所有用户 |
| **主动唤醒** | Heartbeat周期性检查执行 | 所有用户 |
| **MCP集成** | Model Context Protocol外部工具 | 高级用户 |
| **CLI模式** | 命令行直接对话 | 开发者 |
| **技能系统** | 可扩展技能定义 | 开发者 |
| **多平台支持** | TG/Discord/飞书/钉钉等 (后续) | 所有用户 |

### 2.2.2 支持的通道（Channel）

- [x] WebSocket（通用长连接）
- [x] Webhook（HTTP回调）
- [ ] Telegram Bot（长轮询）
- [ ] Discord Bot（WebSocket）
- [ ] WhatsApp（QR码登录+WebSocket）
- [ ] 飞书（WebSocket长连接）
- [ ] 钉钉（Stream模式）
- [ ] Slack（Socket Mode）
- [ ] Email（IMAP/SMTP）
- [ ] QQ私聊（WebSocket）
- [ ] Mochat（Socket.IO）

### 2.2.3 支持的LLM Provider

- [ ] OpenRouter（统一网关）
- [ ] OpenAI（GPT系列）
- [ ] Anthropic（Claude系列）
- [ ] DeepSeek
- [ ] Google Gemini
- [ ] MiniMax
- [ ] Moonshot/Kimi
- [ ] 智谱GLM
- [ ] 阿里Qwen（DashScope）
- [ ] 火山引擎
- [ ] vLLM（本地模型）
- [ ] 自定义OpenAI兼容端点
- [ ] OpenAI Codex（OAuth）
- [ ] GitHub Copilot（OAuth）

### 2.2.4 内置工具

| 工具 | 功能 |
|------|------|
| **read_file** | 读取文件 |
| **write_file** | 写入文件 |
| **edit_file** | 编辑文件 |
| **list_dir** | 列出目录 |
| **exec** | 执行Shell命令 |
| **web_search** | Web搜索 |
| **web_fetch** | 获取网页内容 |
| **spawn** | 触发后台子Agent |
| **cron** | 管理定时任务 |
| **message** | 发送消息到其他通道 |

### 2.2.5 MCP支持

- [ ] Stdio模式（本地进程）
- [ ] HTTP/SSE模式（远程端点）
- [ ] 自定义认证头
- [ ] 工具超时配置

## 2.3 用户故事

### 故事1：个人AI助手部署

> 作为个人用户，我想通过简单的配置在Telegram上与AI助手对话
> 
> **验收标准：**
> - 能在2分钟内完成配置
> - 可以通过Telegram Bot发送消息并收到AI回复
> - 支持文字和图片输入

### 故事2：多平台统一入口

> 作为用户，我想通过多个平台（微信/Telegram/飞书）访问同一个AI助手
> 
> **验收标准：**
> - 可以同时启用多个通道
> - 各通道消息共享同一会话上下文
> - 可以从一个通道向另一个通道发送消息

### 故事3：定时提醒

> 作为用户，我想让AI助手在每天早上9点提醒我查看邮件
> 
> **验收标准：**
> - 可以通过自然语言创建定时任务
> - 任务按计划执行并发送提醒
> - 支持Cron表达式和固定间隔

### 故事4：长期记忆

> 作为用户，我希望AI助手记住重要的个人信息
> 
> **验收标准：**
> - AI可以主动将重要信息写入MEMORY.md
> - 下次对话时自动加载长期记忆
> - 历史对话可grep搜索

### 故事5：本地模型

> 作为开发者，我想运行本地开源大模型
> 
> **验收标准：**
> - 支持vLLM服务
> - 支持LM Studio
> - 支持任何OpenAI兼容端点

## 2.4 非功能需求

| 需求 | 描述 |
|------|------|
| **性能** | 启动时间 < 2秒 |
| **资源** | 内存占用 < 100MB（不含LLM调用） |
| **代码量** | 核心逻辑 < 5000行 |
| **可靠性** | 通道连接自动重试 |
| **安全性** | 支持工作区目录限制 |
| **可扩展** | 新增Provider/Channel仅需少量代码 |
